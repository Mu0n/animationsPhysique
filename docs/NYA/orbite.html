<div class="imageContainer aspectRation2-1"><div id="orbite"></div></div>

<div class="controls">
  <label for="masseCentre">Masse de l'objet central:&nbsp;<input type="range" id="masseCentre" name="masseCentre" value="50" max="65" min="35" step="0.2" oninput="redraw()" onchange="redraw()"></label>
  <button type="button" oninput="redraw()">Click Me!</button>
  </div>
</div>

<script src='utils/includes/vector.js'></script>
<script>
  //Paramètres fudge-factor pour aider à créer une animation satisfaisante
  var constanteG = 125;
  
  //Paramètres de la masse centrale; positions en coordonnées absolues
  var solX = 500;
  var solY = 250;
  
  //Paramètres du satellite; positions en coordonnées absolues
  var posX = 800;
  var posY = 250;
  var vitesseX = 0.0;  var vitesseY = -3;
  var accX = 0.0;  var accY = 0.0;
  
  //Création de l'élément svg (l'image).
  var draw = SVG('orbite').viewbox({ x: 0, y: 0, width: 1000, height: 500 });
  
  //Création des différents éléments de l'image
  var masseCentre = draw.circle(1).attr({ cx: solX, cy: solY, fill: '#ffffff' });
  var masseSat = draw.circle(15).attr({ cx: posX, cy: posY, fill: '#ffffff' });
  
 
	//Redessine l'image en tenant compte des contrôles externes
  redraw();

  function redraw() {
		//Définit et récupère les valeurs nécessaires à l'image.
    var rC = parseFloat(document.getElementById("masseCentre").value);
	//Ajuste les rayons de la source et de l'objet et la position de l'objet.
    masseCentre.radius(rC);

	var locX = localX(posX);
	var locY = localY(posY);

	var distAuCarre = locX*locX + locY*locY;
	var dist = Math.sqrt(distAuCarre);
	
	var acc = constanteG * rC * 1.0 / distAuCarre;
	
	var accX = -(locX / dist) * acc;
	var accY = -(locY / dist) * acc;
	
	//Algorithme Euler-Cromer, la position est modifiée avant la vitesse
	locX += vitesseX;
	locY += vitesseY;
	
	vitesseX += accX;
	vitesseY += accY;
	
	//Rafraichit les positions en coordonnées globales et redessine le satellite
	posX = globalX(locX);
	posY = globalY(locY);
	masseSat.cx(posX).cy(posY);
  }
  
  function localX(globalX){
		var retVal = globalX - solX;
		return retVal;
  }
  
  function  localY(globalY){
		var retVal = solY - globalY;
		return retVal;
  }
  
  function globalX(localX){
		var retVal = localX + solX;
		return retVal;
  }
  
  function globalY(localY){
		var retVal = solY - localY;
		return retVal;
  }

</script>
